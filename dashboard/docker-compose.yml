version: '3'
services:
  waf:
    build: ./apache-modsec
    ports:
      - "8880:8880"
    extra_hosts:
      - "host.docker.internal:host-gateway"
    volumes:
      - modsec-logs:/var/log/apache2
    networks:
      - waf-net
    command: ["apachectl", "-D", "FOREGROUND"]

  dashboard:
    build: ./dashboard
    ports:
      - "8000:8000"
    volumes:
      - modsec-logs:/shared-logs
    networks:
      - waf-net
    depends_on:
      - waf

volumes:
  modsec-logs:

networks:
  waf-net:
    driver: bridge
